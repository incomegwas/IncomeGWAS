# Use this if no access to no past job information

library(data.table)

# READ data (tsv or csv format)
UKB <- 
UKB <- data.table(UKB)

############################################################################################3
############################################################################################3
### required info

UKB[, male := f.31.0.0] 
UKB[, age := as.numeric(f.21003.0.0)]
UKB[, year := substr(f.53.0.0, 1, 4)]  # year of assessment
UKB[, yob := as.numeric(f.34.0.0)]

############################################################################################3
############################################################################################3
### Curent job

UKB[, SOC := f.132.0.0]
UKB[, SOC := substr(f.132.0.0, 1, 4)] 
UKB[, SOC := ifelse(SOC==0, f.20024.0.0, SOC)]

### Exclude too old (>64) 
UKB[, SOC := ifelse(age > 64, NA, SOC)]



############################################################################################3
############################################################################################3
### Get occupational wages

source("./function_script.R")

UKB <- GET_INCOME(UKB)